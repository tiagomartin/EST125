---
title: 'Transforma√ß√µes de vari√°veis: o que s√£o e quando us√°-las na an√°lise de dados'
author: Tiago Pereira
date: '2023-05-01'
slug: transforma-es-de-vari-veis-o-que-s-o-e-quando-us-las-na-an-lise-de-dados
categories:
  - Pr√©-processamento
  - Transforma√ß√µes
tags:
  - Conceitos
  - Pre
subtitle: 'O uso de transforma√ß√µes de vari√°veis em modelos preditivos √© importante para melhorar a qualidade do modelo, corrigindo problemas como assimetria, instabilidade de vari√¢ncia e falta de linearidade.'
summary: 'O uso de transforma√ß√µes de vari√°veis em modelos preditivos √© importante para melhorar a qualidade do modelo, corrigindo problemas como assimetria, instabilidade de vari√¢ncia e falta de linearidade.'
authors: []
lastmod: '2023-05-01T10:12:16-03:00'
featured: no
draft: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
commentable: true
---

Ol√° pessoal, beleza?

Hoje vamos falar sobre um conceito muito importante no contexto de an√°lise de dados: as transforma√ß√µes!


As transforma√ß√µes de vari√°veis s√£o t√©cnicas amplamente utilizadas na estat√≠stica e em outras √°reas das ci√™ncias, como a economia, a psicologia e a medicina, al√©m de ajudar na obten√ß√£o de modelos preditivos mais precisos. Neste post, vamos discutir o que s√£o transforma√ß√µes de vari√°veis, quando elas s√£o usadas e quais s√£o as principais t√©cnicas de transforma√ß√£o.

## O que s√£o transforma√ß√µes de vari√°veis?

As transforma√ß√µes de vari√°veis envolvem um conjunto de m√©todos utilizados para alterar a distribui√ß√£o dos dados, a fim de torn√°-los mais adequados para uma an√°lise espec√≠fica. Isso envolve aplicar uma fun√ß√£o matem√°tica aos dados originais, em uma ou mais vari√°veis dentro do conjunto de dados, com a finalidade de normalizar a distribui√ß√£o dos dados, reduzir a vari√¢ncia, linearizar rela√ß√µes ou tornar a rela√ß√£o entre vari√°veis mais clara.



<a href="http://www.gifbay.com/gif/baller-16126/" target="_blank" rel="noopener noreferrer"><img src="https://media0.giphy.com/media/Nda9GjMZ6BQpa/giphy.gif"  width="700" height="400"></a>


{{% callout note %}}
Aplicar uma transforma√ß√£o adequada em modelos preditivos pode melhorar a qualidade do modelo, pois pode corrigir problemas como assimetria, instabilidade de vari√¢ncia e falta de linearidade, permitindo que o modelo se ajuste melhor aos dados e produza previs√µes mais precisas.
{{% /callout %}} 

## Principais t√©cnicas de transforma√ß√£o


### Transforma√ß√£o logar√≠tmica

A transforma√ß√£o logar√≠tmica √© uma t√©cnica que √© amplamente utilizada em situa√ß√µes em que a vari√°vel tem uma distribui√ß√£o assim√©trica e/ou uma grande vari√¢ncia. 

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(ggpubr)
set.seed(123)
x = 1:1000
v <- 0.5 + 0.005*x
var_het <- rnorm(n = length(x), mean = x, sd = sqrt(v))
dados_assimetricos <- rgamma(1000, 1, 1)

dados = tibble(dados_assimetricos, var_het)
p1 = dados %>% 
  ggplot(aes(x=dados_assimetricos, after_stat(density)))+ 
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Assim√©trico')+
  theme(legend.position='none')+
  theme_pubclean()

p2 = dados %>% 
  mutate(dados_simetricos = log10(dados_assimetricos)) %>% 
  ggplot(aes(x=dados_simetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Transformado')+
  theme(legend.position='none')+
  theme_pubclean()

p1 + p2
```

A transforma√ß√£o logar√≠tmica √© definida pela seguinte equa√ß√£o:

{{< math >}}
$$
y = \log(x)
$$
{{< /math >}}

onde {{< math >}}$x${{< /math >}} √© a vari√°vel a ser transformada e {{< math >}}$y${{< /math >}} √© a vari√°vel transformada. A transforma√ß√£o logar√≠tmica √© uma transforma√ß√£o monot√¥nica, o que significa que n√£o afeta a ordem dos dados. Isso √© importante para modelos preditivos porque garante que a transforma√ß√£o n√£o afete a capacidade do modelo de capturar a rela√ß√£o entre as vari√°veis.

### Transforma√ß√£o raiz quadrada

Assim como a transforma√ß√£o logar√≠tmica, a transforma√ß√£o de raiz quadrada √© uma transforma√ß√£o matem√°tica simples e n√£o param√©trica que pode ser facilmente aplicada em modelos preditivos.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(ggpubr)
set.seed(123)
x = 1:1000
v <- 0.5 + 0.005*x
var_het <- rnorm(n = length(x), mean = x, sd = sqrt(v))
dados_assimetricos <- rgamma(1000, 1, 1)

dados = tibble(dados_assimetricos, var_het)
p1 = dados %>% 
  ggplot(aes(x=dados_assimetricos, after_stat(density)))+ 
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Assim√©trico')+
  theme(legend.position='none')+
  theme_pubclean()

p2 = dados %>% 
  mutate(dados_simetricos = sqrt(dados_assimetricos)) %>% 
  ggplot(aes(x=dados_simetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Transformado')+
  theme(legend.position='none')+
  theme_pubclean()

p1 + p2
```

A transforma√ß√£o de raiz quadrada √© definida pela seguinte equa√ß√£o:

{{< math >}}
$$
y = \sqrt x
$$
{{< /math >}}

onde {{< math >}}$x${{< /math >}} √© a vari√°vel a ser transformada e {{< math >}}$y${{< /math >}} √© a vari√°vel transformada. Assim como a transforma√ß√£o logar√≠timica, a transforma√ß√£o de raiz quadrada √© uma transforma√ß√£o monot√¥nica, o que significa que n√£o afeta a ordem dos dados.

### Transforma√ß√£o de Box-Cox

A transforma√ß√£o de Box-Cox √© uma t√©cnica para transformar vari√°veis em modelos preditivos que √© amplamente utilizada para melhorar a qualidade da modelagem e a precis√£o das previs√µes. √â uma t√©cnica param√©trica que depende de um par√¢metro lambda que √© estimado a partir dos dados, podendo ser usada apenas com vari√°veis n√£o negativas..


```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(ggpubr)
library(caret)
library(bestNormalize)

set.seed(123)
x = 1:1000
v <- 0.5 + 0.005*x
var_het <- rnorm(n = length(x), mean = x, sd = sqrt(v))
dados_assimetricos <- rgamma(1000, 1, 1)

dados = tibble(dados_assimetricos, var_het)
p1 = dados %>% 
  ggplot(aes(x=dados_assimetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Assim√©trico')+
  theme(legend.position='none')+
  theme_pubclean()

p2 = dados %>% 
  mutate(dados_simetricos = predict(boxcox(dados_assimetricos))) %>% 
  ggplot(aes(x=dados_simetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Transformado')+
  theme(legend.position='none')+
  theme_pubclean()

p1 + p2
```


A transforma√ß√£o de Box-Cox √© definida pela seguinte equa√ß√£o:

{{< math >}}
$$
y = 
  \begin{cases}
      \dfrac{(x^\lambda - 1)}{\lambda}, & se \ \lambda \neq  0 \\
      \log(x), & se \ \lambda = 0 
  \end{cases}
$$
{{< /math >}}

onde {{< math >}}$x${{< /math >}} √© a vari√°vel a ser transformada e {{< math >}}$y${{< /math >}} √© a vari√°vel transformada. Esta √© uma t√©cnica de transforma√ß√£o de dados √∫til usada para estabilizar a vari√¢ncia, tornar os dados mais semelhantes √† distribui√ß√£o normal, por exemplo, quando um atributo tem a apar√™ncia de uma curva normal mas est√° descolado para a direita ou esquerda, melhorar a validade das medidas de associa√ß√£o e para outros procedimentos de estabiliza√ß√£o de dados.

### Transforma√ß√£o Yeo-Johnson


A transforma√ß√£o Yeo-Johnson √© uma t√©cnica de transforma√ß√£o semelhante √† transforma√ß√£o de Box-Cox. No entanto, a transforma√ß√£o Yeo-Johnson √© mais flex√≠vel porque pode ser usada para vari√°veis que podem assumir valores negativos. 



```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(patchwork)
library(ggplot2)
library(ggpubr)
library(caret)
library(bestNormalize)

set.seed(123)
x = 1:1000
v <- 0.5 + 0.005*x
var_het <- rnorm(n = length(x), mean = x, sd = sqrt(v))
dados_assimetricos <- rgamma(1000, 1, 1)

dados = data.frame(dados_assimetricos, var_het)
p1 = dados %>% 
  ggplot(aes(x=dados_assimetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Assim√©trico')+
  theme(legend.position='none')+
  theme_pubclean()

p2 = dados %>% 
  mutate(dados_simetricos = predict(yeojohnson(dados_assimetricos))) %>% 
  ggplot(aes(x=dados_simetricos, after_stat(density)))+
  geom_histogram(color = "white", fill = "steelblue")+
  xlab('Atributo Transformado')+
  theme(legend.position='none')+
  theme_pubclean()

p1 + p2
```

A transforma√ß√£o Yeo-Johnson √© definida pela seguinte equa√ß√£o:

{{< math >}}
$$
y = 
  \begin{cases}
      \dfrac{(x + 1)^\lambda - 1}{\lambda}, & se \ x \geq  0, \ \lambda \neq 0 \\
      \ln(x + 1), & se \ x \geq 0 \ \lambda = 0 \\
      \dfrac{-((-x + 1)^{(2 - \lambda)} - 1)}{(2 - \lambda)}, & se \ x <  0, \ \lambda \neq 2 \\
      -\ln(-x+1) & se \ x <  0, \ \lambda = 2 
  \end{cases}
$$
{{< /math >}}

onde {{< math >}}$x${{< /math >}} √© a vari√°vel a ser transformada e {{< math >}}$y${{< /math >}} √© a vari√°vel transformada.


### Em resumo...

Transformar vari√°veis √© √∫til para melhorar a qualidade da modelagem e a precis√£o das previs√µes em modelos preditivos. As transforma√ß√µes s√£o aplicadas √†s vari√°veis independentes para melhorar a distribui√ß√£o, escala e rela√ß√£o com a vari√°vel de sa√≠da. Existem v√°rias t√©cnicas de transforma√ß√£o dispon√≠veis, incluindo transforma√ß√£o logar√≠tmica, transforma√ß√£o de raiz quadrada, transforma√ß√£o de Box-Cox e a  transforma√ß√£o de Yeo-Johnson. 

N√£o h√° uma √∫nica transforma√ß√£o de vari√°veis que seja a melhor para todos os casos. √â importante lembrar que a escolha da transforma√ß√£o deve ser baseada em uma avalia√ß√£o cuidadosa da natureza dos dados e da rela√ß√£o entre as vari√°veis. A transforma√ß√£o escolhida deve ajudar a reduzir a heterogeneidade de vari√¢ncia e normalizar a distribui√ß√£o dos dados, mas tamb√©m deve ser interpret√°vel e fazer sentido do ponto de vista te√≥rico.


At√© breve! üëã